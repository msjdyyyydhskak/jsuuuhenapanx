const { cmd, commands } = require('../lib/command');
const axios = require('axios');

let aiChats = {}; 

cmd({
  on: "body"
}, async (conn, mek, m, { from, body, isGroup, isOwner }) => {
  try {
    if (aiChats[from]) { 
      if (isOwner) return;

      // Gemini Prompt Setup
      const prompt = `‡∂∏‡∂∏ ${m.pushName}, ‡∂î‡∂∂ ‡∑É‡∑ë‡∂∂‡∑ë ‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑ô‡∂ö‡∑î ‡∂∏‡∑ô‡∂±‡∑ä ‡∑Ñ‡∑ê‡∑É‡∑í‡∂ª‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂∫. Meaningful emojis use ‡∂ö‡∂ª‡∂±‡∑ä‡∂±. ‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑î‡∂±‡∑ä‡∂ú‡∑ö ‡∂á‡∂≠‡∑í ‡∑Ñ‡∑ê‡∂ü‡∑ì‡∂∏‡∑ä, ‡∂Ø‡∑ê‡∂±‡∑ì‡∂∏‡∑ä, ‡∑É‡∑Ñ ‡∑É‡∂Ç‡∑Ä‡∑ö‡∂Ø‡∑ì‡∂≠‡∑è‡∑Ä‡∂∫ ‡∂Ö‡∂±‡∑î‡∑Ä ‡∂¥‡∑í‡∂Ω‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±. ‡∂î‡∂∫‡∑è AI ‡∂á‡∑É‡∑í‡∑É‡∑ä‡∂ß‡∂±‡∑ä‡∂ß‡∑ä ‡∂ö‡∑ô‡∂±‡∑ô‡∂ö‡∑ä ‡∂±‡∑ô‡∑Ä‡∑ö, ‡∑É‡∑ë‡∂∂‡∑ë ‡∂∏‡∑í‡∂±‡∑í‡∑Ñ‡∑ô‡∂ö‡∑ä. ‡∂î‡∂∫‡∑è‡∂ú‡∑ô‡∂±‡∑ä ‡∂ö‡∑Ä‡∑î‡∂ª‡∑î‡∑Ñ‡∂ª‡∑í ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫‡∂ö‡∑ä ‡∂á‡∑Ñ‡∑î‡∑Ä‡∑ú‡∂≠‡∑ä ‡∂í‡∂ö ‡∂≠‡∑ö‡∂ª‡∑î‡∂∏‡∑ä ‡∂ú‡∑ô‡∂± ‡∂∏‡∂∏ ‡∂Ø‡∑ì‡∂Ω‡∑è ‡∂≠‡∑í‡∂∫‡∑ô‡∂± ‡∂ã‡∂¥‡∂Ø‡∑ô‡∑É‡∑ä‡∑Ä‡∂Ω‡∂ß ‡∂ú‡∑ê‡∂Ω‡∂¥‡∑ô‡∂±‡∑Ä‡∂±‡∂∏‡∑ä ‡∂í‡∂∫‡∑è‡∂ß ‡∂¥‡∑í‡∂Ω‡∑í‡∂≠‡∑î‡∂ª‡∑î ‡∂Ø‡∑ô‡∂±‡∑ä‡∂±. ‡∂î‡∂∫‡∑è‡∑Ä ‡∑Ñ‡∑ê‡∂Ø‡∑î‡∑Ä‡∑ö ‡∂ö‡∑Ä‡∑î‡∂Ø ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂á‡∑Ñ‡∑î‡∑Ä‡∑ú‡∂≠‡∑ä ‡∑Ä‡∑í‡∂≠‡∂ª‡∂ö‡∑ä ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂± ‡∂∏‡∑è‡∑Ä ‡∑Ñ‡∑ê‡∂Ø‡∑î‡∑Ä‡∑ö ‡∂±‡∑í‡∂¥‡∑î‡∂±‡∑ä  ‡∂Ö‡∂∫‡∑í‡∂∫‡∑è ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è. ‡∂∏‡∂∏ ‡∂±‡∑í‡∂¥‡∑î‡∂±‡∑ä ‡∂ö‡∑í‡∑Ä‡∑ä‡∑Ä‡∑ú‡∂≠‡∑ä ‡∂î‡∂∫‡∑è ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂± ‡∂Ü ‡∂Ö‡∂±‡∑ö ‡∑É‡∂∏‡∑è ‡∑Ä‡∑ô‡∂±‡∑ä‡∂± ‡∂Ö‡∂∫‡∑í‡∂∫‡∑ô ‡∂∏‡∑è‡∑Ä ‡∂î‡∂∫‡∑è ‡∑Ñ‡∑ê‡∂Ø‡∑î‡∑Ä‡∂ß ‡∂∏‡∂ß ‡∂î‡∂∫‡∑è‡∑Ä ‡∂Ö‡∂Ø‡∑î‡∂ª‡∂ú‡∂±‡∑ä‡∂± ‡∂∂‡∑ê‡∂ª‡∑í ‡∂ã‡∂±‡∑è ‡∂î‡∂∫‡∑è ‡∂ö‡∑í‡∂∫‡∂± ‡∂ï‡∂±‡∑í‡∂∏ ‡∑Ä‡∑í‡∂Ø‡∑í‡∑Ñ‡∂ö‡∂ß ‡∂∏‡∂∏  ‡∂â‡∂±‡∑ä‡∂±‡∂∏‡∑ä ‡∂î‡∂∫‡∑è ‡∂∏‡∂ß ‡∂¥‡∂´ ‡∂Ø‡∑î‡∂±‡∑ä‡∂±‡∂ß ‡∂ú‡∑ú‡∂©‡∂ö‡∑ä ‡∑É‡∑ä‡∂≠‡∑ñ‡∂≠‡∑í‡∂∫‡∑í ‡∂Ö‡∂∫‡∑í‡∂∫‡∑ö. ‡∂î‡∂∫‡∑è‡∂ú‡∑ö ‡∂±‡∂∏ ‡∂á‡∑Ñ‡∑î‡∑Ä‡∑ú‡∂≠‡∑ä ‡∑Ä‡∑í‡∂≠‡∂ª‡∂ö‡∑ä ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂± ‡∂∏‡∂ú‡∑ö ‡∂±‡∂∏ QUEEN RASHU MD ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è. ‡∂ö‡∑ê‡∑Ä‡∂Ø ‡∂∂‡∂±‡∑ä ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂á‡∑Ñ‡∑î‡∑Ä‡∑ú‡∂≠‡∑ä ‡∑Ñ‡∑î‡∂≠‡∑ä‡∂≠‡∂ö‡∑ä ‡∂ö‡∑ë‡∑Ä‡∑è ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±. ‡∂≠‡∑Ä ‡∂ª‡∑Å‡∑ñ‡∂ß ‡∑Ñ‡∂ª‡∑í ‡∂±‡∑í‡∂¥‡∑î‡∂±‡∑ä‡∂ß ‡∑Ñ‡∂ª‡∑í ‡∂Ö‡∂∏‡∑ä‡∂∏‡∂ß ‡∑Ñ‡∂ª‡∑í ‡∂≠‡∑è‡∂≠‡∑ä‡∂≠‡∂ß ‡∑Ñ‡∂ª‡∑í ‡∂î‡∂∫‡∑è‡∂ß ‡∑Ñ‡∂ª‡∑í ‡∂∂‡∑ê‡∂±‡∑ä‡∂±‡∑ú‡∂≠‡∑ä ‡∂î‡∂∫‡∑è ‡∂ë‡∂∫‡∑è‡∂ß ‡∂±‡∂ª‡∂ö ‡∑Ä‡∂†‡∂± ‡∂∫‡∑ú‡∂Ø‡∑è‡∂ú‡∑ô‡∂± ‡∂∂‡∂∫‡∑í‡∂±‡∑ä‡∂± (‡∂±‡∂ª‡∂ö ‡∑Ä‡∂†‡∂±: ‡∑Ñ‡∑î‡∂≠‡∑ä‡∂≠‡∑è, ‡∂ö‡∑ê‡∂ª‡∑í‡∂∫‡∑è, ‡¥™‡¥ï‡∂∫‡∑è, ‡∂¥‡∑ú‡∂±‡∑ä‡∂±‡∂∫‡∑è, ‡∑Ä‡∑ö‡∑É‡∑í, ‡∂ö‡∑ú‡∂Ω‡∑ä‡∂Ω‡∑î‡∂ö‡∑è‡∂ª‡∂∫‡∑è, ‡∂±‡∂ú‡∑í‡∂±‡∑ä‡∂±‡∑ö ‡∂±‡∑ê‡∂≠‡∑í ‡∂¥‡∑ú‡∂±‡∑ä‡∂±‡∂∫‡∑è,‡∂Ü‡∂≠‡∂Ω‡∑ä ‡∂ë‡∂ö‡∂ß ‡∑Ñ‡∑î‡∂ö‡∂Ω‡∑è ‡∂ö‡∂ª‡∑î‡∂∏‡∑ô‡∂ß ‡∑Ñ‡∑ê‡∂Ø‡∑î‡∂±‡∑î ‡∂ë‡∂ö‡∑è) ‡∂∏‡∑ö ‡∑Ä‡∂†‡∂± ‡∂ö‡∑í‡∂∫‡∂± ‡∑Ñ‡∑ê‡∂∏‡∑ù‡∂ß‡∂∏ ‡∂∂‡∂∫‡∑í‡∂±‡∑ä‡∂± ,‡∂¥‡∑î‡∂ö ‡∑É‡∑î‡∂Ø‡∑î‡∂Ø ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂á‡∑Ñ‡∑î‡∑Ä‡∑ú‡∂≠‡∑ä ‡∑Ä‡∑í‡∂≠‡∂ª‡∂ö‡∑ä ‡∑É‡∑î‡∂Ø‡∑î‡∂∫‡∑í ‡∂≠‡∂∏‡∑è ‡∂ã‡∂∂‡∂ß ‡∂∏‡∑ú‡∂ö‡∂Ø ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂Ö‡∑Ñ‡∂±‡∑ä‡∂±. English use ‡∂ö‡∂ª‡∂±‡∑ä‚Äç‡∂ª ‡∂ë‡∂¥‡∑è! üòú\n‡∂∏‡∂ú‡∑ö ‡∂¥‡∑ä‚Äç‡∂ª‡∑Å‡∑ä‡∂±‡∂∫: ${body}`;

      const response = await axios.post(
        'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=AIzaSyDKG2kbHCfenwjiFhQCk-m3EXFotzmrrW4',
        {
          contents: [
            {
              parts: [
                {
                  text: prompt
                }
              ]
            }
          ]
        },
        {
          headers: {
            'Content-Type': 'application/json'
          }
        }
      );

      const aiResponse = response.data.candidates?.[0]?.content?.parts?.[0]?.text || "ü§ñ AI ‡∂ë‡∂ö‡∑ö ‡∂¥‡∑í‡∑Ö‡∑í‡∂≠‡∑î‡∂ª‡∂ö‡∑ä ‡∂±‡∑ê‡∑Ñ‡∑ê.";
      await m.reply(aiResponse);
    }
  } catch (e) {
    console.error(e);
    await m.reply(`‚ùå AI Error: ${e.message}`);
  }
});

cmd({
  pattern: "autoai",
  desc: "Enable/Disable Auto AI Response for this Chat or Group",
  category: "ai",
  filename: __filename,
}, async (conn, mek, m, { reply, args, isGroup, isAdmins, isOwner }) => {
  if (isGroup && !isAdmins) return reply("Only group admins can use this command in groups!");
  if (!isGroup && !isOwner) return reply("Only the bot owner can enable AI in private chats!");
  if (args[0] === "on") {
    aiChats[m.chat] = true;
    reply("‚úÖ AI Auto-Response is now *Enabled* for this chat.");
  } else if (args[0] === "off") {
    aiChats[m.chat] = false;
    reply("‚ùå AI Auto-Response is now *Disabled* for this chat.");
  } else {
    reply("Usage: `.autoai on` or `.autoai off`");
  }
});
